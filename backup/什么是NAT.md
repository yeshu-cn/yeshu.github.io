# 网络地址转换(NAT)

## 什么是NAT?

NAT(Network Address Translation,网络地址转换)是一种在IP数据包通过路由器或防火墙时重写源IP地址或目的IP地址的技术。它的主要作用包括:

1. **IP地址映射**:允许多台主机共享一个外部IP地址访问互联网,节省IPv4地址资源。
2. **隐藏私有网络结构**:增加网络安全性,隐藏内部私有网络地址。
3. **应用程序支持**:对需要嵌入IP地址的应用程序数据包进行处理。

## NAT工作原理

1. 维护NAT转换表,记录本地和全局地址的映射关系。
2. 对出站数据包,将私有源IP替换为公网IP。
3. 对入站数据包,将公网目标IP替换为私有IP。

## NAT类型

- **静态NAT**: 固定内外地址的映射关系。
- **动态NAT**: 从IP地址池中临时分配公网IP地址。
- **端口地址转换NAT(PAT/NAPT)**: 多台主机复用同一公网IP,通过不同端口区分。

## IP地址和端口转换(IPT)

IPT(IP and Port Translation)是NAT的一种形式,允许私有网络内多个设备共享一个公网IP地址访问互联网。

### IPT工作流程

1. 私有网络设备使用私有IP上网,数据包到达NAT网关。
2. NAT网关将私有源IP和端口转换为公网IP和新端口,并记录转换映射。
3. 修改后的数据包发往互联网。
4. 响应数据返回时,NAT网关将目标转换回私有IP和端口,转发给客户端。
5. 这样私网多设备就可复用同一公网IP地址上网。

### IPT优缺点

- **优点**:节省公网IPv4地址资源,增强网络安全性。
- **缺陸**:不能很好支持某些网络应用,可能引入网络时延。

总之,NAT和IPT作为解决IPv4地址匮乏和保护内网安全的有效技术,在当下IPv4网络环境下得到了广泛应用。